package kevin.module.modules.exploit

import kevin.module.ListValue
import kevin.module.Module
import kevin.module.ModuleCategory
import kevin.utils.ChatUtils
import net.minecraft.network.play.client.C02PacketUseEntity
import net.minecraft.network.play.client.C03PacketPlayer
import java.util.*

class Kick : Module("Kick", "Allows you to kick yourself from a server.", category = ModuleCategory.EXPLOIT) {
    private val modeValue = ListValue("Mode", arrayOf("Quit", "InvalidPacket", "SelfHurt", "IllegalChat", "PacketSpam"), "Quit")

    override fun onEnable() {
        if (mc.isIntegratedServerRunning) {
            ChatUtils().message("§c§lError: §aYou can't enable §c§l'Kick' §ain SinglePlayer.")
            return
        }

        val player = mc.thePlayer!!

        when (modeValue.get().toLowerCase()) {
            "quit" -> mc.theWorld!!.sendQuittingDisconnectingPacket()
            "invalidpacket" -> mc.netHandler.addToSendQueue(C03PacketPlayer.C04PacketPlayerPosition(Double.NaN, Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY, !player.onGround))
            "selfhurt" -> mc.netHandler.addToSendQueue(C02PacketUseEntity(player, C02PacketUseEntity.Action.ATTACK))
            "illegalchat" -> player.sendChatMessage(Random().nextInt().toString() + "§§§" + Random().nextInt())
            "packetspam" -> {
                repeat(9999) {
                    mc.netHandler.addToSendQueue(C03PacketPlayer.C04PacketPlayerPosition(it.toDouble(), it.toDouble(), it.toDouble(),
                        Random().nextBoolean()))
                }
            }
        }
        toggle(false)
    }
}